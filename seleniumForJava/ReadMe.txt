======================================================================

     自動回帰テストツール『seleniumForJava』（スタンドアロン版） Version 3.0

              Copyright (c) 2023 liushuang Co.Ltd.

                                最終更新日：2022/09/07
                                開発・配布：liushuang
                                 Webサイト：
                                    メール：liushuang393@sina.com
======================================================================

この度は自動テストツール『seleniumForJava』（スタンドアロン版）を利用
していただき、誠にありがとうございます。
このファイルでは、『seleniumForJava』の使用方法やその他の重要な情報について
説明しています。
ソフトウェアを使用する前に、必ず最後まで目を通していただけますよう
お願いします。

======================================================================
目次
======================================================================
 1. 概要
 2. 動作環境
 3. ファイル構成
 4. インストール
 5. アンインストール
 6. 使い方
 7. キーワードファイルについて
 8. 使用許諾条件
 9. 免責事項
10. 著作権
11. お問い合わせ
12. FAQ、制限事項
13. バージョン履歴
----------------------------------------------------------------------

======================================================================
1. 概要
======================================================================

『seleniumForJava』は、キーワード駆動の自動テストツール
です。
seleniumIDEで画面を録画し、Sideファイル（JSON）保存し、Sideファイルから
Excelファイルシナリオを作成できます。
Excelファイルも要素の定義や動作の記述を行うため、プログラム言語の知識
がなくても自動テストを実行できます。
期待値の比較やテストNG時にスクリーンショットを保存する機能もあります。


======================================================================
2. 動作環境
======================================================================

Java Runtime Environment(JRE)が必要です。
※JRE 1.8以上推奨

キーワードファイルの編集にはExcelが必要です。
※Excel 2013以上推奨。

======================================================================
3. ファイル構成
======================================================================

seleniumForJava_Standalone
フォルダー パスの一覧:  ボリューム ボリューム
│  01_Excel版シナリオ作成.bat
│  02_シナリオ自動テスト.bat
│  config.properties
│  ReadMe.txt
│  seleniumForJava.jar
│  
├─evidence
├─exe
│  │  prePrintPDFForIE.au3
│  │  prePrintPDFForIE.exe
│  │  printPDF.au3
│  │  printPDF.exe
│  │  selenium-server-4.3.0.jar
│  │  server.bat
│  │  
│  ├─100
│  │  │  chromedriver.exe
│  │  │  chromedriver_win32.zip
│  │  │  edgedriver_win64.zip
│  │  │  geckodriver.exe
│  │  │  IEDriverServer.exe
│  │  │  msedgedriver.exe
│  │  │  
│  │  └─Driver_Notes
│  │          credits.html
│  │          EULA
│  │          LICENSE
│  │          
│  ├─101
│  │      chromedriver.exe
│  │      geckodriver.exe
│  │      IEDriverServer.exe
│  │      msedgedriver.exe
│  │      
│  ├─102
│  │      chromedriver.exe
│  │      geckodriver.exe
│  │      IEDriverServer.exe
│  │      msedgedriver.exe
│  │      
│  ├─103
│  │  │  chromedriver.exe
│  │  │  geckodriver.exe
│  │  │  IEDriverServer.exe
│  │  │  msedgedriver.exe
│  │  │  
│  │  └─Driver_Notes
│  │          credits.html
│  │          EULA
│  │          LICENSE
│  │          
│  ├─104
│  │  │  chromedriver.exe
│  │  │  geckodriver.exe
│  │  │  IEDriverServer.exe
│  │  │  msedgedriver.exe
│  │  │  
│  │  └─Driver_Notes
│  │          credits.html
│  │          EULA
│  │          LICENSE
│  │          
│  ├─95
│  │      chromedriver.exe
│  │      geckodriver.exe
│  │      IEDriverServer.exe
│  │      IEDriverServer_64.exe
│  │      msedgedriver.exe
│  │      
│  ├─96
│  │  │  chromedriver.exe
│  │  │  geckodriver.exe
│  │  │  IEDriverServer.exe
│  │  │  msedgedriver.exe
│  │  │  
│  │  └─Driver_Notes
│  │          credits.html
│  │          EULA
│  │          LICENSE
│  │          
│  ├─97
│  │  │  chromedriver.exe
│  │  │  geckodriver.exe
│  │  │  IEDriverServer.exe
│  │  │  msedgedriver.exe
│  │  │  
│  │  └─Driver_Notes
│  │          credits.html
│  │          EULA
│  │          LICENSE
│  │          
│  ├─98
│  │  │  chromedriver.exe
│  │  │  geckodriver.exe
│  │  │  IEDriverServer.exe
│  │  │  msedgedriver.exe
│  │  │  
│  │  └─Driver_Notes
│  │          credits.html
│  │          EULA
│  │          LICENSE
│  │          
│  └─99
│      │  chromedriver.exe
│      │  chromedriver_win32 (2).zip
│      │  edgedriver_win64 (3).zip
│      │  geckodriver.exe
│      │  IEDriverServer.exe
│      │  msedgedriver.exe
│      │  
│      └─Driver_Notes
│              credits.html
│              EULA
│              LICENSE
│              
├─input
│  ├─side
│  │          
│  ├─Templete
│  │      CT_Template.xlsx
│  │      ITA_01_CT0001-Sample.xlsx
│  │      
│  └─移行前　#自動生成
│  └─移行後　#自動生成
│          
├─java
│  ├─8
│  │                      
│  └─lib
│      ├─commlib
│      │      
│      ├─selenium-java-4.0.0-beta-4
│      │  └─lib
│      ├─selenium-java-4.1.0
│      │  └─lib
│      ├─selenium-java-4.1.2
│      │  └─lib
│      ├─selenium-java-4.2.2
│      │  └─lib
│      ├─selenium-java-4.3.0
│      │  └─lib
│      └─selenium-java-4.4.0  
│          └─lib
│                  
└─logs

======================================================================
4. インストール
======================================================================

ダウンロードしたzipファイルを解凍ツールで解凍し、「seleniumForJava_Standalone」
フォルダを任意の場所にコピーしてください。

======================================================================
5. アンインストール
======================================================================

フォルダごと削除してください。
※レジストリは操作していません。

======================================================================
6. 使い方
======================================================================

【Windowsの場合】

1. 「seleniumForJava_Standalone」フォルダを開きます。

2. 01_手順書_シナリオ録画.xlsx
　02_手順書_シナリオ作成・自動テスト.xlsx

【Macの場合】
　対応なし

======================================================================
7. キーワードファイルについて
======================================================================

キーワードファイル（キーワードを記述するExcelファイル）の内容ついて
説明します。

-----------------------
[checklist]シート
-----------------------
概要
・ブラウザー種類設定、テスト対象の要素（WebElements）をページ毎に定義するシートです。
項目
	・No.
	・動作指示（A,B,C,E)
	・コマンド（Command）
	・オプション	(Option)
	・ターゲット	(Target)
	・項目説明	(Description)⇒手動更新
	・値	(Value)
	・結果（result）
	・日付(date)
	・エラーメッセージ	(error messages)
	・備考	(remark)

======================================================================
8. 使用許諾条件
======================================================================

自動テストツール『seleniumForJava』（以下、本ソフトウェア）は、下記条項にご同意
いただいた方にのみご使用いただけます。ご同意いただけない場合、本ソフト
ウェアを使用することは出来ません。使用を中止し、ただちに本ソフトウェア
を破棄してください。
本ソフトウェアを使用された場合は下記条項にご同意いただけたものとさせて
いただきます。

パッケージ内のファイルに一切変更を加えない限り、再配布することを可能と
します。

製作者の判断、及び国家機関の命令等により、本ソフトウェアの使用停止が公示
された場合、速やかに使用を取りやめるものとします。

本ソフトウェアに対するリバースエンジニアリング及び、改変は一切禁止します。

雑誌等へ掲載する場合は、事前に連絡をお願いします。

なお、これらの条項につきましては利用者の事前の了承を得ることなしに追加、
変更することがあります。

======================================================================
9. 免責事項
======================================================================

本ソフトウェアは現状有姿にて提供されるものです。

本ソフトウェアはフリーウェアです。個人使用、業務使用に関わらず、ご自由
にご利用ください。

本ソフトウェアを利用した結果、もしくは利用できないことにより発生した損害、
ならびに二次的に発生した一切の損害に対する保証は致しかねます。あらかじめ
ご了承ください。

======================================================================
10. 著作権
======================================================================

本ソフトウェアの著作権はliushuangに帰属します。

本ソフトウェア及び内容物は、著作権法及び国際著作権条約をはじめ、財産権、
所有権、知的財産権、その他の無体財産権に関する法律ならびに条約によって
保護されています。

======================================================================
11. お問い合わせ
======================================================================

ご意見、ご感想、ご要望、バグなどありましたら、お手数ですが下記メール
アドレスまでご連絡いただけると幸いです。
ご要望やバグへの対応をお約束することは致しかねますが、今後の開発の参考
とさせていただきたいと思います。

  お問い合わせ先：liushuang393@sina.com

======================================================================
12. FAQ、制限事項
======================================================================

----------------------------------------------------------------------
・どのブラウザでのテストが可能ですか？
----------------------------------------------------------------------
  下記のブラウザでのテストが可能です。
  Windows
   - Google Chrome
   - Firefox
   - Internet Explorer
   - Microsoft Edge
   - Microsoft Edge(IE Mode)
  Mac
   未対応

　＜注意事項＞
　◆ドライバについて
　・Seleniumではブラウザ毎に異なるドライバが必要になります。
　　ブラウザの更新に合わせて、ドライバも順次更新されている状況ですので、
　　ブラウザのバージョンアップにより正常に動作しなくなった場合は、
　　最新のドライバを使用して動作をご確認ください。
　　
　　最新のドライバに関する情報はSeleniumのダウンロードサイトにて確認
　　できます。
　　http://www.seleniumhq.org/download/
　　
　　seleniumForJavaでは、本書「3. ファイル構成」のdriverフォルダに格納された
　　ドライバを使用しますので、別途ダウンロードしたドライバをdriver
　　フォルダに格納してください。
　　ファイル名は既存のファイルに合わせてください。
　　
　　例：最新のgeckodriver.exe（Windows 64ビット用）を使用する場合

　◆Microsoft Edge用のドライバについて
　・Microsoft Edgeでテストするためには、Windows 10のOSビルド番号に合った
　　Microsofot WebDriverが必要になります。
　　seleniumForJavaには同梱していないため、下記マイクロソフトのサイトより
　　該当バージョンのWebDriverをダウンロードしてください。

　　https://developer.microsoft.com/en-us/microsoft-edge/tools/webdriver/

　　※ダウンロードしたドライバのEXEファイル「MicrosoftWebDriver.exe」は
　　　seleniumForJavaのdriverフォルダに配置してください。

　　　　seleniumForJava_Standalone
　　　　├ exe
　　　　│ ├ MicrosoftWebDriver.exe

　　※Release 14393より古いドライバでは、sendKeysによる日本語入力には
　　　対応していないようです。
　　　マルチバイト文字を入力するとエラーが発生しますのでご注意ください。

　◆32ビットOSでの使用について
　・下記の事象が発生しており、現時点では64ビットOSでの使用を推奨して
　　おります。
　　
　　・Firefox
　　　テスト完了後に「Firefoxは動作を停止しました」と表示される
　　
　　・Internet Explorer
　　　ブラウザ起動後、localhostから遷移せず、テストが実行されない

　◆64ビットOSのInternet Explorer
　・64ビットOS用のドライバを使用すると、文字入力（SendKeys）の動作が
　　遅くなります。
　　64ビットOSの場合でも、Internet Explorerでテストする場合には、
　　32ビットOS用のドライバを使用することをお勧めします。
　　
　　※キーワードファイルの[Environment]シートを下記のように設定します。
　　　・PlatformName   ：Windows_32
　　　・BrowserName    ：InternetExplorer

　◆Microsoft Edge
　・

----------------------------------------------------------------------
・スマートフォンアプリのテストは可能ですか？
----------------------------------------------------------------------
  現時点ではスマートフォン、タブレット端末で動作するネイティブアプリ、
  ブラウザでのテストは未対応となっております。

----------------------------------------------------------------------
・Windowsアプリケーションのテストは可能ですか？
----------------------------------------------------------------------
  Windowsアプリケーションのテストには対応しておりません。

----------------------------------------------------------------------
・ネットワーク上のフォルダでseleniumForJavaを起動するにはどうしたらいいですか？
----------------------------------------------------------------------
  ネットワーク上のフォルダをネットワークドライブとして割り当ててから
  再度お試しください。

----------------------------------------------------------------------
・Internet Explorerでテストする場合の注意点
----------------------------------------------------------------------
  あらかじめ、下記のように設定しておく必要があります。
  ・ブラウザの表示倍率を「100％」に設定してください。
  ・テスト対象のサイトを「信頼済みサイト」に追加してください。
  ・Internet Explorerのセキュリティ設定で、全てのゾーンの保護モードを
    揃える必要があります。
    seleniumForJavaを起動する前に、インターネットオプションよりセキュリティタブ
    を開き、全てのゾーンの保護モードを有効または無効のいずれかに統一
    してください。

  また、初回起動時にWindowsファイアウォールによりブロックされている旨
  表示される場合があります。その場合は、「アクセスを許可する」、または
  「キャンセル」を選択してください。

----------------------------------------------------------------------
・Alert画面のスクリーンショットは取得できますか？
----------------------------------------------------------------------
  画面全体を（ブラウザの枠やOSのタスクバーなども含めて）キャプチャ
  して取得します。
  そのため、ブラウザの前面に他の画面などがあると、その画面も含めて
  キャプチャされますので、実行時はブラウザを最前面にしてください。

----------------------------------------------------------------------
・スクリーンショットがずれていることがあります
----------------------------------------------------------------------
  横スクロールバーが表示されている状態で全画面のスクリーンショットを
  取得すると、横スクロールバーが画像に含まれてしまい、一部ずれた状態
  で画像が生成されてしまうことが確認されています。
  より大きなディスプレイを使用するなど、横スクロールバーが表示されない
  状態でのご使用をご検討下さい。

======================================================================
13. バージョン履歴
======================================================================

録画ツール：　autoit-v3.3.14.0\install\Extras\Au3Record\Au3Record.exe 
=======================================
V3
1.POP画面対応
2.ブラウザ104版対応
3.非同期処理時間を改善
4.値クリアできないを改善（B票003：検索テキストボックス値「＊」になった）
5.マウスオーバーエラー対応、無効なマウスオーバーを無視して、続けて処理
6.キーの組み合わせ対応
7.AssertAlert 実現
8.自動テストソフトウェアによって制御されています 解除
9.tagets全て利用し、要素を取得
10.テスト完了全て画面を閉じる
11.自動キャプチャ保存制限flg機能追加、自動自動キャプチャ保存なしボタン、リンクid設定できる。
12.プログラムでブラウザーを利用しｐｄｆ作成時、画面遷移退避策追加
13.ブラウザ104版対応、lib2.4.0対応
14.キャプチャ保存zoom80%に変更（A4　横）
15.ブランク値の設定対応（テキストボックス、プルダウンリスト）
------------------------------------------------
=======================================
V2
1.Close、 MOUSEOVER、MOUSEOUT、WINDOWSWITCH命令追加
2.非同期処理時、項目取得対応
3.ブラウザ103版対応、lib2.3.0対応
4.css Selectorたまたま無効なので、xpath
5.テスト実施時、シナリオファイルが開いている場合、提示を追加

------------------------------------------------
V1

2022/06/15　劉
1.エビデンスをクリアバグ対応

２．キャプチャ保存、png、pdf分けてできる対応

V1
1.2022/02/11 　劉
　　・アップロード出来ます。
　　・画面コントロール値Excelに保存できる。
　　
2.2022/02/11 　劉
　　・ブラウザDriverバージョン対応バッグ修正

3.2022/04/14 劉
　　・Enter発送対応　CommandSendKeysを追加
　　・実行環境構築便利ため、ユーザー・ライブラリーファイルを追加
　　　　02_手順書_シナリオ作成・自動テスト.xlsx
4.2022/04/26 劉
　　キャプチャー名を＃を_に変更
　　WinMergeで利用ため、#、"など含む時、差異の場合リンクが利用できない。
5.202206/24　劉
　インストールしない、利用可能にようにパスの対応
6.202206/24　劉
　IEモードを利用可能

======================================================================

※Java は、Oracle Corporationおよびその関連企業の登録商標です。

※Microsoft、Excel、Internet Explorer、Edgeは、米国 Microsoft Corporation の、
  米国およびその他の国における登録商標または商標です。

※Firefoxは、米国 Mozilla Foundation の米国及びその他の国における
  商標または登録商標です。

※Google Chromeは、Google Inc.の商標または登録商標です。

※Mac、Mac OSは、米国および他の国々で登録されたApple Inc.の商標です。

※本ソフトウェアは Apache License, Version 2.0 のライセンスで配布されて
  いる成果物を含んでいます。

※This software includes the work that is distributed in the Apache 
    License 2.0 (http://www.apache.org/licenses/LICENSE-2.0)

※その他使用している社名・製品名は、各社の商標または登録商標です。

======================================================================

    Copyright (c) 2017 Nihon Knowledge Co.Ltd. All rights reserved.
                     http://www.know-net.co.jp/


=======TODO　リスト==========================================================
①webdrivermanagerでWebDriver管理、自動ダウンロード
<dependency>
    <groupId>io.github.bonigarcia</groupId>
    <artifactId>webdrivermanager</artifactId>
    <version>5.0.3</version>
</dependency>

②JarはMavenで管理
③DB新旧比較
--------------------------------------------------------------------
=======手順==========================================================
■ブラウザを追加対応
　準備作業：Driverのダウンロード
　　例：https://www.selenium.dev/downloads/
　　↓↓
　　seleniumForJava\exe\
　　└IEDriverServer.exe

①.input\Templete\CT_Templete.xlsx
　・「checklist」シートのG4にブラウザ種類を追加。例：「IE」
　
②WebDriverControl.initDriver() 
		case IE:
			System.setProperty("webdriver.ie.driver", "exe/IEDriverServer.exe");
			 driver  = new InternetExplorerDriver();
			log.info("{} is started.[WebDriver:{}]", "exe/IEDriverServer.exe", "IE（64・32)"); 
			break;

関連ところ

・CommandOpen.Action()
　（WebDriverControl）drvctrl.setWebDriverType(action.getParent().getBrowser());

・webDriver Jar　Supported CDP versions 情報：
4.0.0-beta-4:　不明　92～96？
4.1.0:        Supported CDP versions: 85, 94, 95, 96
4.1.2:		　Supported CDP versions: 85, 95, 96, 97
4.2.3:　　　　Supported CDP versions: 85, 100, 101, 102
4.3.0:		　Supported CDP versions: 85, 101, 102, 103
4.4.0:		　Supported CDP versions: 85, 102, 103, 104
